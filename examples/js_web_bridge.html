    <script src="https://thunkable.github.io/webviewer-extension/thunkableWebviewerExtension.js" type="text/javascript"></script>

<script type="text/javascript">
      ThunkableWebviewerExtension.receiveMessageWithReturnValue(function(message, callback) {
        try {
          const msgFromApp = JSON.parse(message);
          let result = null;

          if (msgFromApp.type === "mathOperation") {
            const num1 = parseFloat(msgFromApp.num1);
            const num2 = parseFloat(msgFromApp.num2);
            
            if (msgFromApp.operation === "add") {
              result = num1 + num2;
            } else if (msgFromApp.operation === "subtract") {
              result = num1 - num2;
            } else if (msgFromApp.operation === "multiply") {
              result = num1 * num2;
            } else if (msgFromApp.operation === "divide") {
              result = num2 !== 0 ? num1 / num2 : "Error: Division by zero";
            }
          } 
          else if (msgFromApp.type === "isPalindrome") {
            const str = msgFromApp.string.toLowerCase().replace(/[^a-z0-9]/g, '');
            result = str === str.split("").reverse().join("");
          } 
          else if (msgFromApp.type === "reverseString") {
            result = msgFromApp.string.split("").reverse().join("");
          }

          // Send response back to Thunkable
          callback(String(result));

          // Update HTML for debugging
          document.getElementById("response").innerText = `Received: ${message} â†’ Result: ${result}`;

        } catch (e) {
          console.error("Error processing message:", e);
        }
      });
    </script>
